

### 简介

本项目旨在通过鼠标点击快速识别博德之门3游戏中的英语字幕，并在屏幕上方弹出对应的官方中文翻译。该工具使用了OCR技术和自然语言处理技术，弹框翻译速度在0.1秒内。视频演示：https://www.bilibili.com/video/BV1VzeAeCETy

![示例图片](example.png)


### 技术栈

- **OCR**：使用[PaddleOCR](https://github.com/PaddlePaddle/PaddleOCR)进行屏幕截图中的文字识别。
- **自然语言处理**：使用`sklearn`中的TF-IDF向量化和余弦相似度计算，匹配最接近的翻译句子。
- **GUI**：使用`tkinter`实现翻译结果的弹框显示。
- **鼠标事件监听**：通过`pynput`库监听鼠标按键事件，并触发翻译功能。


### 详细技术路线

1. **字幕与翻译的XML解析**：
    - 使用`xml.etree.ElementTree`解析存储在XML文件中的字幕数据。
    - 提取英文句子及其对应的中文翻译，存储在两个列表中。

2. **TF-IDF向量化**：
    - 使用`TfidfVectorizer`将提取的英文句子进行向量化处理，生成TF-IDF特征矩阵。

3. **OCR识别**：
    - 使用`PaddleOCR`识别截取屏幕中的字幕文本，并输出识别结果，包括文字内容和位置信息。

4. **文本过滤**：
    - 使用正则表达式`re`对OCR结果进行预处理，去除不必要的字符和标记，保留纯净的文本内容。（目的是去除杂乱字符，让后续的相似度匹配准确度提升）

5. **相似度匹配**：
    - 使用`cosine_similarity`计算OCR识别结果与XML中英文句子的相似度，找出最相似的句子及其对应的翻译。

6. **弹框显示**：
    - 使用`tkinter`库创建弹框窗口，并将最匹配的中文翻译显示在窗口中。弹框位置动态调整，显示在鼠标正上方100像素的位置。

7. **鼠标事件监听**：
    - 通过`pynput.mouse.Listener`监听鼠标的侧键点击事件，当点击检测到时，执行上述OCR识别和翻译匹配流程，并显示或关闭弹框。

### 使用方法

备注：如果要安装GPU版panddleocr，请参考panddleocr官网方法，以下是安装CPU版，OCR识别速度未测。

1. 安装依赖库：
    ```bash
    pip install pyautogui pillow tkinter numpy paddleocr scikit-learn pynput
    ```



2. 运行脚本：
    - 在游戏运行的同时，运行本程序。按下鼠标侧键即可触发字幕翻译功能。

### 注意事项

- OCR识别结果依赖于截图区域，请在适当的游戏分辨率和窗口尺寸下使用，有些参数可自行调整。



